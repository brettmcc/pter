*********Input market work hours constraints, marginal wages, and vacation variables. Information about housework *********
*********income, market labor hours, and demographics are processed in other programs                             ********* 
*********WantAble1971-1975, 1979-1984 and 1986-1987 are process by additional macros                              *********;
%include '..\setlibraries_psid.sas';

data temp.WantAble1968;
set psiddata.fam68;
id1968             =    V3    ;  
wantmore1967       =    V231  ;  
wantless1967       =    V233  ;  
ablemore1967       =    V230  ;  
ableless1967       =    V232  ;  
vacationwks1967    =    V222  ;  
if vacationwks1967=9 then vacationwks1967=99;

if wantmore1967 = 1 and ablemore1967 = 5 then construp1967 = 1; else construp1967 = 0;
if wantless1967 = 1 and ableless1967 = 5 then constrdown1967 = 1; else constrdown1967 = 0;
keep id1968 construp1967 constrdown1967 vacationwks1967;
run;

data temp.WantAble1969;
set psiddata.fam69;
id1969             =    V442  ;  
wantmore1968       =    V668  ;  
wantless1968       =    V670  ;  
ablemore1968       =    V666  ;  
ableless1968       =    V669  ;  
marwage1968        =    V667  ;  
if marwage1969 in (9.99,0) then marwage1969=.; 
vacation1968       =    V652  ;  
vacationwks1968    =    V653  ;  
if vacationwks1969=9 then vacationwks1968=99;

if wantmore1968 = 1 and ablemore1968 = 5 then construp1968 = 1; else construp1968 = 0;
if wantless1968 = 1 and ableless1968 = 5 then constrdown1968 = 1; else constrdown1968 = 0;
keep id1969 construp1968 constrdown1968 marwage1968 vacation1968 vacationwks1968;
run;

data temp.WantAble1970;
set psiddata.fam70;
id1970             =    V1102 ; 
wantmore1969       =    V1305 ; 
wantless1969       =    V1307 ; 
ablemore1969       =    V1304 ; 
ableless1969       =    V1306 ; 
vacation1969       =    V1286 ; 
vacationwks1969    =    V1287 ; 

if wantmore1969 = 1 and ablemore1969 = 5 then construp1969 = 1; else construp1969 = 0;
if wantless1969 = 1 and ableless1969 = 5 then constrdown1969 = 1; else constrdown1969 = 0;
keep id1970 construp1969 constrdown1969 vacation1969 vacationwks1969;
run;

data temp.WantAble1971;
set psiddata.fam71;
id1971             =    V1802 ;
wantmore1970       =    V2011 ;
wantless1970       =    V2013 ;
ablemore1970       =    V2010 ;
ableless1970       =    V2012 ;
WifeAbleMore1970   =    V2078 ;
WifeWantMore1970   =    V2079 ;
vacation1970       =    V1992 ;
vacationwks1970    =    V1993 ;
keep id1971 wantmore1970 wantless1970 ablemore1970 ableless1970 vacation1970 vacationwks1970 wifeablemore1970 wifewantmore1970;
run;

data temp.WantAble1972;
set psiddata.fam72;
id1972             =    V2402 ; 
wantmore1971       =    V2609 ; 
wantless1971       =    V2611 ; 
ablemore1971       =    V2608 ; 
ableless1971       =    V2610 ; 
WifeAbleMore1971   =    V2676 ;
WifeWantMore1971   =    V2677 ;
vacation1971       =    V2590 ; 
vacationwks1971    =    V2591 ; 
keep id1972 wantmore1971 wantless1971 ablemore1971 ableless1971 vacation1971 vacationwks1971 wifeablemore1971 wifewantmore1971;
run;

data temp.WantAble1973;
set psiddata.fam73;
id1973             =    V3002 ; 
wantmore1972       =    V3142 ; 
wantless1972       =    V3144 ; 
ablemore1972       =    V3141 ; 
ableless1972       =    V3143 ; 
WifeAbleMore1972   =    V3187 ;
WifeWantMore1972   =    V3188 ;
vacation1972       =    V3123 ; 
vacationwks1972    =    V3124 ; 
keep id1973 wantmore1972 wantless1972 ablemore1972 ableless1972 vacation1972 vacationwks1972 wifeablemore1972 wifewantmore1972;
run;

data temp.WantAble1974;
set psiddata.fam74;
id1974             =    V3402 ;  
wantmore1973       =    V3557 ;  
wantless1973       =    V3559 ;  
ablemore1973       =    V3556 ;  
ableless1973       =    V3558 ;  
WifeAbleMore1973   =    V3605 ;
WifeWantMore1973   =    V3606 ;
vacation1973       =    V3538 ;  
vacationwks1973    =    V3539 ;  
keep id1974 wantmore1973 wantless1973 ablemore1973 ableless1973 vacation1973 vacationwks1973 wifeablemore1973 wifewantmore1973;
run;

data temp.WantAble1975;
set psiddata.fam75;
id1975             =    V3802 ; 
wantmore1974       =    V4012 ; 
wantless1974       =    V4014 ; 
ablemore1974       =    V4011 ; 
ableless1974       =    V4013 ; 
WifeAbleMore1974   =    V4061 ;
WifeWantMore1974   =    V4062 ;
vacation1974       =    V3991 ; 
vacationwks1974    =    V3992 ; 
keep id1975 wantmore1974 wantless1974 ablemore1974 ableless1974 vacation1974 vacationwks1974 wifeablemore1974 wifewantmore1974;
run;

data temp.WantAble1976;
set psiddata.fam76;
id1976             =    V4302 ;
wantmore1975       =    V4527 ;
wantless1975       =    V4529 ;
ablemore1975       =    V4524 ;
ableless1975       =    V4528 ;
WifeAbleMore1975   =    V4907 ;
WifeWantMore1975   =    V4910 ;
marwage1975        =    V4525 ;
if marwage1975 in (9.99,0) then marwage1975=.; 
vacation1975       =    V4500 ;
vacationwks1975    =    V4501 ;
wifevacation1975       =    V4883 ;
wifevacationwks1975    =    V4884 ;

if wantmore1975 = 1 and ablemore1975 = 5 then construp1975 = 1; else construp1975 = 0;
if wantless1975 = 1 and ableless1975 = 5 then constrdown1975 = 1; else constrdown1975 = 0;
if wifewantmore1975 = 1 and wifeablemore1975 = 5 then wifeconstrup1975 = 1; else wifeconstrup1975 = 0;
keep id1976 construp1975 constrdown1975 wifeconstrup1975 vacation1975 vacationwks1975 marwage1975 wifevacation1975 wifevacationwks1975;
run;

data temp.WantAble1977;
set psiddata.fam77;
id1977             =    V5202 ; 
wantmore1976       =    V5436 ; 
wantless1976       =    V5438 ; 
ablemore1976       =    V5434 ; 
ableless1976       =    V5437 ; 
marwage1976        =    V5435 ;
if marwage1976 in (9.99,0) then marwage1976=.; 
vacation1976       =    V5409 ; 
vacationwks1976    =    V5410 ; 
wifevacation1976       =    V5514 ; 
wifevacationwks1976    =    V5515 ; 

if wantmore1976 = 1 and ablemore1976 = 5 then construp1976 = 1; else construp1976 = 0;
if wantless1976 = 1 and ableless1976 = 5 then constrdown1976 = 1; else constrdown1976 = 0;
keep id1977 construp1976 constrdown1976 vacation1976 vacationwks1976 marwage1976 wifevacation1976 wifevacationwks1976;
run;

data temp.WantAble1978;
set psiddata.fam78;
id1978             =    V5702 ;                            
wantmore1977       =    V5923 ;                            
wantless1977       =    V5925 ;                            
ablemore1977       =    V5921 ;                            
ableless1977       =    V5924 ;                            
marwage1977        =    V5922 ; 
if marwage1977 in (99.99,0) then marwage1977=.;  
vacation1977       =    V5898 ;                            
vacationwks1977    =    V5899 ;                            
wifevacation1977       =    V6045 ;                            
wifevacationwks1977    =    V6046 ;                            

if wantmore1977 = 1 and ablemore1977 = 5 then construp1977 = 1; else construp1977 = 0;
if wantless1977 = 1 and ableless1977 = 5 then constrdown1977 = 1; else constrdown1977 = 0;
keep id1978 construp1977 constrdown1977 vacation1977 vacationwks1977 marwage1977 wifevacation1977 wifevacationwks1977;
run;

data temp.WantAble1979;
set psiddata.fam79;
id1979             =    V6302 ;                            
wantmore1978       =    V6536 ;                            
wantless1978       =    V6535 ;                            
wantless21978      =    V6538 ;                            
ablemore1978       =    V6532 ;                            
ableless1978       =    V6534 ;                            
ableless21978      =    V6537 ;                            
marwage1978        =    V6533 ;   
if marwage1978 in (99.99,0) then marwage1978=.;   
vacation1978       =    V6509 ;                            
vacationwks1978    =    V6510 ;                            
wifevacation1978       =    V6605 ;                            
wifevacationwks1978    =    V6606 ;                            
keep id1979 wantmore1978 wantless1978 ablemore1978 ableless1978 marwage1978 vacation1978 vacationwks1978 wantless21978 ableless21978 wifevacation1978 wifevacationwks1978;
run;

data temp.WantAble1980;
set psiddata.fam80;
id1980             =    V6902 ;                            
wantmore1979       =    V7139 ;                            
wantless1979       =    V7138 ;                            
wantless21979      =    V7141 ;                            
ablemore1979       =    V7135 ;                            
ableless1979       =    V7137 ;                            
ableless21979      =    V7140 ;                            
marwage1979        =    V7136 ;     
if marwage1979 in (99.99,0) then marwage1979=.;   
vacation1979       =    V7112 ;                            
vacationwks1979    =    V7113 ;                            
wifevacation1979       =    V7207 ;                            
wifevacationwks1979    =    V7208 ;                            
keep id1980 wantmore1979 wantless1979 ablemore1979 ableless1979 marwage1979 vacation1979 vacationwks1979 wantless21979 ableless21979 wifevacation1979 wifevacationwks1979;
run;

data temp.WantAble1981;
set psiddata.fam81;
id1981             =    V7502 ;                            
wantmore1980       =    V7786 ;                            
wantless1980       =    V7785 ;                            
wantless21980      =    V7788 ;                            
ablemore1980       =    V7782 ;                            
ableless1980       =    V7784 ;                            
ableless21980      =    V7787 ;                            
marwage1980        =    V7783 ;   
if marwage1980 in (99.99,0) then marwage1980=.;   
vacation1980       =    V7735 ;                            
vacationwks1980    =    V7736 ;                            
wifevacation1980       =    V7898 ;                            
wifevacationwks1980    =    V7899 ;                            
keep id1981 wantmore1980 wantless1980 ablemore1980 ableless1980 marwage1980 vacation1980 vacationwks1980 wantless21980 ableless21980 wifevacation1980 wifevacationwks1980;
run;

data temp.WantAble1982;
set psiddata.fam82;
id1982             =    V8202 ;                            
wantmore1981       =    V8451 ;                            
wantless1981       =    V8450 ;                            
wantless21981      =    V8453 ;                            
ablemore1981       =    V8447 ;                            
ableless1981       =    V8449 ;                            
ableless21981      =    V8452 ;                            
marwage1981        =    V8448 ;      
if marwage1981 in (99.99,0) then marwage1981=.;  
vacation1981       =    V8397 ;                            
vacationwks1981    =    V8398 ;                            
wifevacation1981       =    V8556 ;                            
wifevacationwks1981    =    V8557 ;                            
keep id1982 wantmore1981 wantless1981 ablemore1981 ableless1981 marwage1981 vacation1981 vacationwks1981 wantless21981 ableless21981 wifevacation1981 wifevacationwks1981;
run;

data temp.WantAble1983;
set psiddata.fam83;
id1983             =    V8802 ;                            
wantmore1982       =    V9082 ;                            
wantless1982       =    V9081 ;                            
wantless21982      =    V9084 ;                            
ablemore1982       =    V9078 ;                            
ableless1982       =    V9080 ;                            
ableless21982      =    V9083 ;                            
marwage1982        =    V9079 ;  
if marwage1982 in (99.99,0) then marwage1982=.;  
vacation1982       =    V9028 ;                            
vacationwks1982    =    V9029 ;                            
wifevacation1982       =    V9206 ;                            
wifevacationwks1982    =    V9207 ;                            
keep id1983 wantmore1982 wantless1982 ablemore1982 ableless1982 marwage1982 vacation1982 vacationwks1982 wantless21982 ableless21982 wifevacation1982 wifevacationwks1982;
run;

data temp.WantAble1984;
set psiddata.fam84;
id1984             =    V10002;                            
wantmore1983       =    V10582;                            
wantless1983       =    V10581;                            
wantless21983      =    V10584;                            
ablemore1983       =    V10578;                            
ableless1983       =    V10580;                            
ableless21983      =    V10583;                            
marwage1983        =    V10579;              
if marwage1983 in (99.99,0) then marwage1983=.;  
vacation1983       =    V10553;                            
vacationwks1983    =    V10554;                            
wifevacation1983       =    V10767;                            
wifevacationwks1983    =    V10768;                            
keep id1984 wantmore1983 wantless1983 ablemore1983 ableless1983 marwage1983 vacation1983 vacationwks1983 wantless21983 ableless21983 wifevacation1983 wifevacationwks1983;
run;

data temp.WantAble1985;
set psiddata.fam85;
id1985             =    V11102;                            
wantmore1984       =    V11736;                            
wantless1984       =    V11735;                            
wantless21984      =    V11738;                            
ablemore1984       =    V11732;                            
ableless1984       =    V11734;                            
ableless21984      =    V11737;                            
WifeAbleMore1984   =    V12095;
WifeWantMore1984   =    V12099;
marwage1984        =    V11733;     
if marwage1984 in (99.99,0) then marwage1984=.;  
vacation1984       =    V11697;                            
vacationwks1984    =    V11698;                            
wifevacation1984       =    V12060;                            
wifevacationwks1984    =    V12061;                            

if wantmore1984 = 1 and ablemore1984 = 5 then construp1984 = 1; else construp1984 = 0;
if (wantless1984 = 1 and ableless1984 = 5) or (wantless21984 = 1 and ableless21984 = 5) then constrdown1984 = 1; else constrdown1984 = 0;
if wifewantmore1984 = 1  and wifeablemore1984 = 5 then wifeconstrup1984 = 1; else wifeconstrup1984 = 0;
keep id1985 construp1984 wifeconstrup1984 constrdown1984 marwage1984 vacation1984 vacationwks1984 wifevacation1984 wifevacationwks1984;
run;

data temp.WantAble1986;
set psiddata.fam86;
id1986             =    V12502;                            
wantmore1985       =    V13136;                            
wantless1985       =    V13135;                            
wantless21985      =    V13138;                            
ablemore1985       =    V13132;                            
ableless1985       =    V13134;                            
ableless21985      =    V13137;                            
marwage1985        =    V13133;      
if marwage1985 in (99.99,0) then marwage1985=.;  
vacation1985       =    V13097;                            
vacationwks1985    =    V13098;                            
wifevacation1985       =    V13274;                            
wifevacationwks1985    =    V13275;                            
keep id1986 wantmore1985 wantless1985 ablemore1985 ableless1985 marwage1985 vacation1985 vacationwks1985 wantless21985 ableless21985 wifevacation1985 wifevacationwks1985;
run;

data temp.WantAble1987;
set psiddata.fam87;
id1987             =    V13702;                            
wantmore1986       =    V14234;                            
wantless1986       =    V14233;                            
wantless21986      =    V14236;                            
ablemore1986       =    V14230;                            
ableless1986       =    V14232;                            
ableless21986      =    V14235;                            
marwage1986        =    V14231;
if marwage1986 in (99.99,0) then marwage1986=.;  
vacation1986       =    V14195;                            
vacationwks1986    =    V14196;                            
wifevacation1986       =    V14368;                            
wifevacationwks1986    =    V14369;                            
keep id1987 wantmore1986 wantless1986 ablemore1986 ableless1986 marwage1986 vacation1986 vacationwks1986 wantless21986 ableless21986 wifevacation1986 wifevacationwks1986;                                                        
run;

%macro wa1(year1, year2);
data temp.WantAble&year1.;
set temp.WantAble&year1.;
if wantmore&year2. = 1 and ablemore&year2. = 5 then construp&year2. = 1; else construp&year2. = 0;
if wantless&year2. = 1 and ableless&year2. = 5 then constrdown&year2. = 1; else constrdown&year2. = 0;
if wifewantmore&year2. = 1 and wifeablemore&year2. = 5 then wifeconstrup&year2. = 1; else wifeconstrup&year2. = 0;
keep id&year1. construp&year2. wifeconstrup&year2. constrdown&year2. vacation&year2. vacationwks&year2.;
run;
%mend;
%wa1(1971, 1970) %wa1(1972, 1971) %wa1(1973, 1972) %wa1(1974, 1973) %wa1(1975, 1974);

%macro wa2(year1, year2);
data temp.WantAble&year1.;
set temp.WantAble&year1.;
if wantmore&year2. = 1 and ablemore&year2. = 5 then construp&year2. = 1; else construp&year2. = 0;
if (wantless&year2. = 1 and ableless&year2. = 5) or (wantless2&year2. = 1 and ableless2&year2. = 5) then constrdown&year2. = 1; else constrdown&year2. = 0;
keep id&year1. construp&year2. marwage&year2. constrdown&year2. vacation&year2. vacationwks&year2. wifevacation&year2. wifevacationwks&year2.;
run;
%mend;
%wa2(1979, 1978) %wa2(1980, 1979) %wa2(1981, 1980) %wa2(1982, 1981) %wa2(1983, 1982) %wa2(1984, 1983) %wa2(1986, 1985) %wa2(1987, 1986);
