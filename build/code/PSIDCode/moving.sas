data move1968;
set psiddata.fam68;
id1968                       =           V3           ;           
mightmove1968                =           V111         ;           
whymightmove1968             =           V112         ;           
keep id1968 mightmove1968 whymightmove1968;

data move1969;
set psiddata.fam69;
id1969                       =           V442         ;           
moved1969                    =           V603         ;           
whymoved1969                 =           V604         ;           
mightmove1969                =           V605         ;           
whymightmove1969              =           V606         ;           
keep id1969 moved1969 whymoved1969 mightmove1969 whymightmove1969;

data move1970;
set psiddata.fam70;
id1970                       =           V1102        ;           
moved1970                    =           V1274        ;           
whymoved1970                 =           V1275        ;           
mightmove1970                =           V1276        ;           
whymightmove1970              =           V1277        ;           
keep id1970 moved1970 whymoved1970 mightmove1970 whymightmove1970;

data move1971;
set psiddata.fam71;
id1971                       =           V1802        ;           
moved1971                    =           V1979        ;           
whymoved1971                 =           V1980        ;           
mightmove1971                =           V1981        ;           
whymightmove1971              =           V1982        ;           
keep id1971 moved1971 whymoved1971 mightmove1971 whymightmove1971;

data move1972;
set psiddata.fam72;
id1972                       =           V2402        ;           
moved1972                    =           V2577        ;           
whymoved1972                 =           V2578        ;           
mightmove1972                =           V2579        ;           
whymightmove1972              =           V2580        ;           
keep id1972 moved1972 whymoved1972 mightmove1972 whymightmove1972;

data move1973;
set psiddata.fam73;
id1973                       =           V3002        ;           
moved1973                    =           V3110        ;           
whymoved1973                 =           V3111        ;           
mightmove1973                =           V3112        ;           
whymightmove1973              =           V3113        ;           
keep id1973 moved1973 whymoved1973 mightmove1973 whymightmove1973;

data move1974;
set psiddata.fam74;
id1974                       =           V3402        ;           
moved1974                    =           V3524        ;           
whymoved1974                 =           V3525        ;           
mightmove1974                =           V3526        ;           
whymightmove1974              =           V3527        ;           
keep id1974 moved1974 whymoved1974 mightmove1974 whymightmove1974;

data move1975;
set psiddata.fam75;
id1975                       =           V3802        ;           
moved1975                    =           V3941        ;           
whymoved1975                 =           V3942        ;           
mightmove1975                =           V3943        ;           
whymightmove1975              =           V3946        ;           
keep id1975 moved1975 whymoved1975 mightmove1975 whymightmove1975;

data move1976;
set psiddata.fam76;
id1976                       =           V4302        ;           
moved1976                    =           V4452        ;           
whymoved1976                 =           V4454        ;           
mightmove1976                =           V4455        ;           
whymightmove1976             =           V4457        ;           
keep id1976 moved1976 whymoved1976 mightmove1976 whymightmove1976;

data move1977;
set psiddata.fam77;
id1977                       =           V5202        ;           
moved1977                    =           V5366        ;           
whymoved1977                 =           V5368        ;           
mightmove1977                =           V5369        ;           
likelihood1977               =           V5370        ;           
whymightmove1977              =           V5371        ;           
keep id1977 moved1977 whymoved1977 likelihood1977 mightmove1977 whymightmove1977;


data move1978;
set psiddata.fam78;
id1978                       =           V5702        ;           
moved1978                    =           V5866        ;           
whymoved1978                 =           V5868        ;           
mightmove1978                =           V5869        ;           
likelihood1978               =           V5870        ;           
whymightmove1978              =           V5871        ;           
keep id1978 moved1978 whymoved1978 likelihood1978 mightmove1978 whymightmove1978;

data move1979;
set psiddata.fam79;
id1979                       =           V6302        ;           
moved1979                    =           V6484        ;           
whymoved1979                 =           V6486        ;           
mightmove1979                =           V6487        ;           
likelihood1979               =           V6488        ;           
whymightmove1979              =           V6489        ;           
keep id1979 moved1979 whymoved1979 likelihood1979 mightmove1979 whymightmove1979;

data move1980;
set psiddata.fam80;
id1980                       =           V6902        ;           
moved1980                    =           V7089        ;           
whymoved1980                 =           V7091        ;           
mightmove1980                =           V7092        ;           
likelihood1980               =           V7093        ;           
whymightmove1980              =           V7094        ;           
keep id1980 moved1980 whymoved1980 likelihood1980 mightmove1980 whymightmove1980;

data move1981;
set psiddata.fam81;
id1981                       =           V7502        ;           
moved1981                    =           V7700        ;           
whymoved1981                 =           V7702        ;           
mightmove1981                =           V7703        ;           
likelihood1981               =           V7704        ;           
whymightmove1981              =           V7705        ;           
keep id1981 moved1981 whymoved1981 likelihood1981 mightmove1981 whymightmove1981;

data move1982;
set psiddata.fam82;
id1982                       =           V8202        ;           
moved1982                    =           V8369        ;           
whymoved1982                 =           V8370        ;           
mightmove1982                =           V8371        ;           
likelihood1982               =           V8372        ;           
whymightmove1982              =           V8373        ;           
keep id1982 moved1982 whymoved1982 likelihood1982 mightmove1982 whymightmove1982;

data move1983;
set psiddata.fam83;
id1983                       =           V8802        ;           
moved1983                    =           V8999        ;           
whymoved1983                 =           V9001        ;           
mightmove1983                =           V9002        ;           
likelihood1983               =           V9003        ;           
whymightmove1983              =           V9004        ;           
keep id1983 moved1983 whymoved1983 likelihood1983 mightmove1983 whymightmove1983;

data move1984;
set psiddata.fam84;
id1984                       =           V10002       ;           
moved1984                    =           V10447       ;           
whymoved1984                 =           V10449       ;           
mightmove1984                =           V10450       ;           
likelihood1984               =           V10451       ;           
whymightmove1984              =           V10452       ;           
keep id1984 moved1984 whymoved1984 likelihood1984 mightmove1984 whymightmove1984;

data move1985;
set psiddata.fam85;
id1985                       =           V11102       ;           
moved1985                    =           V11628       ;           
whymoved1985                 =           V11630       ;           
mightmove1985                =           V11631       ;           
likelihood1985               =           V11632       ;           
whymightmove1985              =           V11633       ;           
keep id1985 moved1985 whymoved1985 likelihood1985 mightmove1985 whymightmove1985;

data move1986;
set psiddata.fam86;
id1986                       =           V12502       ;           
moved1986                    =           V13037       ;           
whymoved1986                 =           V13039       ;           
mightmove1986                =           V13040       ;           
likelihood1986               =           V13041       ;           
whymightmove1986              =           V13042       ;           
keep id1986 moved1986 whymoved1986 likelihood1986 mightmove1986 whymightmove1986;

data move1987;
set psiddata.fam87;
id1987                       =           V13702       ;           
moved1987                    =           V14140       ;           
whymoved1987                 =           V14142       ;           
mightmove1987                =           V14143       ;           
likelihood1987               =           V14144       ;           
whymightmove1987              =           V14145       ;           
keep id1987 moved1987 whymoved1987 likelihood1987 mightmove1987 whymightmove1987;

data move1988;
set psiddata.fam88;
id1988                       =           V14802       ;           
moved1988                    =           V15148       ;           
whymoved1988                 =           V15150       ;           
mightmove1988                =           V15151       ;           
likelihood1988               =           V15152       ;           
whymightmove1988              =           V15153       ;           
keep id1988 moved1988 whymoved1988 likelihood1988 mightmove1988 whymightmove1988;

data move1989;
set psiddata.fam89;
id1989                       =           V16302       ;           
moved1989                    =           V16649       ;           
whymoved1989                 =           V16651       ;           
mightmove1989                =           V16652       ;           
likelihood1989               =           V16653       ;           
whymightmove1989              =           V16654       ;           
keep id1989 moved1989 whymoved1989 likelihood1989 mightmove1989 whymightmove1989;

data move1990;
set psiddata.fam90;
id1990                       =           V17702       ;           
moved1990                    =           V18087       ;           
whymoved1990                 =           V18089       ;           
mightmove1990                =           V18090       ;           
likelihood1990               =           V18091       ;           
whymightmove1990              =           V18092       ;           
keep id1990 moved1990 whymoved1990 likelihood1990 mightmove1990 whymightmove1990;

data move1991;
set psiddata.fam91;
id1991                       =           V19002       ;           
moved1991                    =           V19387       ;           
whymoved1991                 =           V19389       ;           
mightmove1991                =           V19390       ;           
likelihood1991               =           V19391       ;           
whymightmove1991              =           V19392       ;           
keep id1991 moved1991 whymoved1991 likelihood1991 mightmove1991 whymightmove1991;

data move1992;
set psiddata.fam92;
id1992                       =           V20302       ;           
moved1992                    =           V20687       ;           
whymoved1992                 =           V20689       ;           
mightmove1992                =           V20690       ;           
likelihood1992               =           V20691       ;           
whymightmove1992              =           V20692       ;           
keep id1992 moved1992 whymoved1992 likelihood1992 mightmove1992 whymightmove1992;

data move1993;
set psiddata.fam93;
id1993                       =           V21602       ;           
moved1993                    =           V22441       ;           
whymoved1993                 =           V22444       ;           
mightmove1993                =           V22445       ;           
likelihood1993               =           V22446       ;           
keep id1993 moved1993 whymoved1993 likelihood1993 mightmove1993 whymightmove1993;

data move1994;
set psiddata.fam94;
id1994                       =           ER2002       ;           
moved1994                    =           ER2062       ;           
whymoved1994                 =           ER2065       ;           
keep id1994 moved1994 whymoved1994;

data move1995;
set psiddata.fam95;
id1995                       =           ER5002       ;           
moved1995                    =           ER5061       ;           
whymoved1995                 =           ER5064       ;           
keep id1995 moved1995 whymoved1995;

data move1996;
set psiddata.fam96;
id1996                       =           ER7002       ;           
moved1996                    =           ER7155       ;           
whymoved1996                 =           ER7158       ;           
mightmove1996                =           ER7161       ;           
likelihood1996               =           ER7162       ;           
keep id1996 moved1996 whymoved1996 likelihood1996 mightmove1996;

data move1997;
set psiddata.fam97;
id1997                       =           ER10002      ;           
moved1997                    =           ER10072      ;           
whymoved1997                 =           ER10075      ;           
mightmove1997                =           ER10079      ;           
likelihood1997               =           ER10080      ;           
keep id1997 moved1997 whymoved1997 likelihood1997 mightmove1997;

data move1999;
set psiddata.fam99;
id1999                       =           ER13002      ;           
moved1999                    =           ER13077      ;           
whymoved1999                 =           ER13080      ;           
mightmove1999                =           ER13084      ;           
likelihood1999               =           ER13085      ;           
keep id1999 moved1999 whymoved1999 likelihood1999 mightmove1999;

data move2001;
set psiddata.fam01;
id2001                       =           ER17002      ;           
moved2001                    =           ER17088      ;           
whymoved2001                 =           ER17091      ;           
mightmove2001                =           ER17095      ;           
likelihood2001               =           ER17096      ;           
keep id2001 moved2001 whymoved2001 likelihood2001 mightmove2001;

data move2003;
set psiddata.fam03;
id2003                       =           ER21002      ;           
moved2003                    =           ER21117      ;           
whymoved2003                 =           ER21120      ;           
mightmove2003                =           ER21121      ;           
likelihood2003               =           ER21122      ;           
keep id2003 moved2003 whymoved2003 likelihood2003 mightmove2003;

data move2005;
set psiddata.fam05;
id2005                       =           ER25002      ;           
moved2005                    =           ER25098      ;           
whymoved2005                 =           ER25101      ;           
mightmove2005                =           ER25102      ;           
likelihood2005               =           ER25103      ;           
keep id2005 moved2005 whymoved2005 likelihood2005 mightmove2005;

data move2007;
set psiddata.fam07;
id2007                       =           ER36002      ;           
moved2007                    =           ER36103      ;           
whymoved2007                 =           ER36106      ;           
mightmove2007                =           ER36107      ;           
likelihood2007               =           ER36108      ;           
keep id2007 moved2007 whymoved2007 likelihood2007 mightmove2007;

data move2009;
set psiddata.fam09;
id2009                       =           ER42002      ;           
moved2009                    =           ER42132      ;           
whymoved2009                 =           ER42135      ;           
mightmove2009                =           ER42138      ;           
likelihood2009               =           ER42139      ;           
keep id2009 moved2009 whymoved2009 likelihood2009 mightmove2009;


*********************************1994 1995 data of might move are imputed******************************************************;
data pid;
set PSIDDATA.person;
if id1993 ne . and id1994 ne . and id1995 ne .;
if rel1993 = 10  and rel1994 = 10 and rel1995 = 10;
if seqno1993 = 1 and seqno1994 = 1 and seqno1995 = 1;
keep pid id1993 id1994 id1995;
proc sort;
by id1993;

data u;
merge move1993(in = in1) pid(in = in2);
by id1993;
if in1 and in2;
proc sort;
by id1995;
data u;
merge move1995(in = in1) u(in = in2);
by id1995;
if in1 and in2;
proc sort;
by id1994;

data move1994;
merge move1994 u;
by id1994;
likelihood1994 = 0;
if moved1995 = 1 then do; mightmove1994 = 1; likelihood1994 = 1; end;
else if mightmove1993 = 1 and moved1993 ne 1 and moved1994 ne 1 then do; mightmove1994 = 1; likelihood1994 = 2; end;
else mightmove1994 = 5;
keep id1994 moved1994 whymoved1994 mightmove1994;


data pid;
set PSIDDATA.person;
if id1993 ne . and id1994 ne . and id1995 ne . and id1996 ne .;
if rel1993 = 10  and rel1994 = 10 and rel1995 = 10 and rel1996 = 10;
if seqno1993 = 1 and seqno1994 = 1 and seqno1995 = 1 and seqno1996 = 1;
keep pid id1993 id1994 id1995 id1996;
proc sort;
by id1993;

data u;
merge move1993(in = in1) pid(in = in2);
by id1993;
if in1 and in2;
proc sort;
by id1994;
data u;
merge move1994(in = in1) u(in = in2);
by id1994;
if in1 and in2;
proc sort;
by id1996;
data u;
merge move1996(in = in1) u(in = in2);
by id1996;
if in1 and in2;
proc sort;
by id1995;

data move1995;
merge move1995 u;
by id1995;
likelihood1995 = 0;
if moved1996 = 1 then do; mightmove1995 = 1; likelihood1995 = 1; end;
else if mightmove1993 = 1 and moved1993 ne 1 and moved1994 ne 1 and moved1995 ne 1 then do; 
     mightmove1995 = 1; likelihood1995 = 2; 
     end;
else mightmove1995 = 5;
keep id1995 moved1995 whymoved1995 mightmove1995;

data psiddata.moving;
merge move1968 move1969 move1970 move1971 move1972 move1973 move1974 move1975 move1976 move1977 move1978 move1979
      move1980 move1981 move1982 move1983 move1984 move1985 move1986 move1987 move1988 move1989 
	  move1990 move1991 move1992 move1993 move1994 move1995 move1996 move1997 move1999 move2001 move2003 move2005 move2007 move2009;
run; 
